# MultiSelect

An extensible combobox component with below set of features,

1. Single option searchable select
2. Multiple option searchable select
3. Async options fetch in above modes
4. ListBox select with Rapid-Typeahead support
5. Render custom components with/without built-in components
6. Virtualized options list within Popper JS
7. List autocomplete with manual selection.
8. List autocomplete with automatic selection.

Most of the composition/behaviour built in this component is based on the
inspiration from [React-Select](//react-select.com/async).

## Import

Chakra Components exports 12 components to render MultiSelect:

- `MultiSelect`: The wrapper component that provides context, manages hooks and
  renders the default components.
- `MultiSelectInputGroup`: A wrapper to group the below 3 components in place.
- `MultiSelectInput`: An auto-size input with text field.
- `MultiSelectPlaceholder`: The component that renders the placeholder for the
  input.
- `MultiSelectSelectedOption`: The component that renders the selected options.
- `MultiSelectRightElements`: A wrapper to group
  `MultiSelectLoader`,`MultiSelectCloseButton` and `MultiSelectToggleIcon`
- `MultiSelectLoader`: The component that renders the spinner icon.
- `MultiSelectCloseButton`: The component that renders the close button.
- `MultiSelectToggleIcon`: The component that renders the toggle icon.
- `MultiSelectRightAddons`: The component that used to properly place all the
  right elements.
- `MultiSelectList`: The component that holds the Popper and Virtualized list.
- `MultiSelectOption`: The component that show the options in a virtualized
  list.

```js
import {
  MultiSelect,
  MultiSelectInputGroup,
  MultiSelectInput,
  MultiSelectPlaceholder,
  MultiSelectSelectedOption,
  MultiSelectRightElements,
  MultiSelectRightAddons,
  MultiSelectLoader,
  MultiSelectCloseButton,
  MultiSelectToggleIcon,
  MultiSelectList,
  MultiSelectOption,
} from "@chakra-components/core";
```

## Searchable Single Option Select

- This component lets you manually choose a single options by matching certain
  number of characters typed in the textbox or manually selecting it via
  keyboard/mouse.
- It behaves as a
  [WAI-ARAI-Combobox](//www.w3.org/TR/wai-aria-practices/#combobox) - List
  autocomplete with manual selection.

```jsx
function MultiSelectExample() {
  const fruits = [
    "Acai",
    "Apples",
    "Apricots",
    "Avocado",
    "Ackee",
    "Bananas",
    "Bilberries",
    "Blueberries",
    "Blackberries",
    "Boysenberries",
    "Bread fruit",
  ];

  const options = fruits.map((d, i) => ({
    value: d,
    label: d,
  }));

  const [fruit, setFruit] = useState(null);

  return (
    <MultiSelect
      options={options}
      value={fruit}
      onChange={setFruit}
      placeholder="Select a fruit..."
    />
  );
}
```

## Searchable Multi Option Select

- This component lets you manually choose a multiple options by matching certain
  number of characters typed in the textbox or manually selecting it via
  keyboard/mouse.
- It also behaves as a
  [WAI-ARAI-Combobox](//www.w3.org/TR/wai-aria-practices/#combobox) - List
  autocomplete with manual selection.

```jsx
function MultiSelectExample() {
  const fruits = [
    "Acai",
    "Apples",
    "Apricots",
    "Avocado",
    "Ackee",
    "Bananas",
    "Bilberries",
    "Blueberries",
    "Blackberries",
    "Boysenberries",
    "Bread fruit",
  ];

  const options = fruits.map((d, i) => ({
    value: d,
    label: d,
  }));

  const [fruit, setFruit] = useState(null);

  return (
    <MultiSelect
      isMulti
      options={options}
      value={fruit}
      onChange={setFruit}
      placeholder="Select a fruit..."
    />
  );
}
```

## ListBox Option Select

- This component lets you automatically choose a single options by matching
  certain number of characters typed in the textbox with Rapid Typeahead support
  when listbox is closed.
- Also with listbox open, this lets you manually select a single option as
  previous components.
- It behaves as a
  [WAI-ARAI-Combobox](//www.w3.org/TR/wai-aria-practices/#combobox) - List
  autocomplete with both automatic & manual selection.

```jsx
function MultiSelectExample() {
  const fruits = [
    "Acai",
    "Apples",
    "Apricots",
    "Avocado",
    "Ackee",
    "Bananas",
    "Bilberries",
    "Blueberries",
    "Blackberries",
    "Boysenberries",
    "Bread fruit",
  ];

  const options = fruits.map((d, i) => ({
    value: d,
    label: d,
  }));

  const [fruit, setFruit] = useState(null);

  return (
    <MultiSelect
      isListBox
      options={options}
      value={fruit}
      onChange={setFruit}
      placeholder="Select a fruit..."
    />
  );
}
```

## Async

- Using `isAsync` prop, lets you load options from a remote source as you type.
- Async component supports single and multi options selection completely.
- ListBox behaviour is support only with `cacheOptions` and filtering is done by
  `filteredBy` prop.

### Async Single Searchable Option Select with defaultOptions

- Use `loadOption` function to send resolved callback or errored callback from
  promises.
- The defaultOptions prop determines "when" your remote request is initially
  fired.
- There are two valid values for this property.

1. **`defaultOptions` - true**

Providing the prop by itself (or with 'true') tells the control to immediately
fire the remote request, described by your loadOptions, to get those initial
values for the Select.

```jsx
function MultiSelectExample() {
  const loadOptions = (inputValue, successCb, errorCb) => {
    axios
      .get(`https://restcountries.eu/rest/v2/name/${inputValue}`)
      .then(response => {
        successCb(
          response.data.map(ep => ({
            label: `${ep.name}`,
            value: `${ep.name}`,
            code: `${ep.alpha2Code}`,
            timeZone: `${ep.timezones[0]}`,
          })),
        );
      })
      .catch(e => {
        errorCb("Remote fetch failed");
      });
  };

  const [country, setCountry] = useState(null);

  return (
    <MultiSelect
      isAsync
      loadOptions={loadOptions}
      defaultOptions
      value={country}
      onChange={setCountry}
      placeholder="Select a country..."
    />
  );
}
```

2. **`defaultOptions` - [{}]**

Providing an option array to this prop will populate the initial set of options
used when opening the select, at which point the remote load only occurs when
filtering the options (typing in the control).

```jsx
function MultiSelectExample() {
  const [defaultOptions, setDefaultOptions] = useState([]);

  const loadOptions = (inputValue, successCb, errorCb) => {
    axios
      .get(`https://restcountries.eu/rest/v2/name/${inputValue}`)
      .then(response => {
        successCb(
          response.data.map(ep => ({
            label: `${ep.name}`,
            value: `${ep.name}`,
            code: `${ep.alpha2Code}`,
            timeZone: `${ep.timezones[0]}`,
          })),
        );
      })
      .catch(e => {
        errorCb("Remote fetch failed");
      });
  };

  useEffect(() => {
    axios.get(`https://restcountries.eu/rest/v2/all`).then(response => {
      setDefaultOptions(
        response.data.map(ep => ({
          label: `${ep.name}`,
          value: `${ep.name}`,
          code: `${ep.alpha2Code}`,
          timeZone: `${ep.timezones[0]}`,
        })),
      );
    });
  }, []);

  const [country, setCountry] = useState(null);

  return (
    <MultiSelect
      isAsync
      loadOptions={loadOptions}
      defaultOptions
      value={country}
      onChange={setCountry}
      placeholder="Select a country..."
    />
  );
}
```

## Props Table

### MenuBar Props

| Name                       | Type                        | Default           | Description                                                                                                |
| -------------------------- | --------------------------- | ----------------- | ---------------------------------------------------------------------------------------------------------- |
| options                    | `array`                     | []                | List of options to select a value                                                                          |
| value                      | `array`, `string`, `number` | []                | Single value or list of controlled values                                                                  |
| onChange                   | `function`                  |                   | Handler to change the controlled value                                                                     |
| placeholder                | `string`                    | `Select one...`   | Placeholder to show inside the input                                                                       |
| isMulit                    | `boolean`                   | `false`           | If `true`, behaves as a multi-select component                                                             |
| isListBox                  | `boolean`                   | `false`           | If `true`, behaves as a listbox component                                                                  |
| isAsync                    | `boolean`                   | `false`           | If `true`, adds the async functionality                                                                    |
| loadOptions                | `function`                  |                   | Handler to get the resolved options with arguments `inputValue`, `successCb` & `errorCb`                   |
| defaultOptions             | `array`, `boolean`          | []                | If `true`, default options will be fetched from loadOptions. If `array`, it will use the provided options. |
| cacheOptions               | `boolean`                   | `false`           | If `true`, all the async options will be cached                                                            |
| filteredBy                 | `function`                  | `in-build filter` | Handler to pass custom filter to filter the option                                                         |
| renderCustomPlaceholder    | `React.ReactNode`           |                   | Custom Placeholder JSX made with `MultiSelectPlaceholder` with context support                             |
| renderCustomSelectedOption | `React.ReactNode`           |                   | Custom SelectedOption JSX made with `MultiSelectSelectedOption` with context support                       |
| renderCustomInput          | `React.ReactNode`           |                   | Custom Input JSX made with `MultiSelectInput` with context support                                         |
| renderCustomCloseButton    | `React.ReactNode`           |                   | Custom CloseButton JSX                                                                                     |
| renderCustomSpinner        | `React.ReactNode`           |                   | Custom Spinner JSX                                                                                         |
| renderCustomOption         | `React.ReactNode`           |                   | Custom Option JSX with context support                                                                     |
| renderCustomNoOption       | `React.ReactNode`           |                   | Custom NoOption JSX with context support                                                                   |
