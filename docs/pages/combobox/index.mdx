# ComboBox

A combobox option that supports

1. Single option select
2. Multiple option select
3. Disabled options
4. Async options fetching
5. Typeahead & autocomplete support
6. Disabled options
7. Virtualizing large lists


## Import

```js
import { 
  ComboBox,
  ComboBoxInput,
  ComboBoxPopup,
  ComboBoxClearElement,
  ComboBoxRightElement
} from "@chakra-components/core";
```

### Basic ComboBox

```jsx
function ComboBoxExample() {
  const fruits = [
    "Acai",
    "Apples",
    "Apricots",
    "Avocado",
    "Ackee",
    "Bananas",
    "Bilberries",
  ];

  const options = fruits.map((d, i) => ({
    value: d,
    label: d,
  }));

  const handleFruitChange = (fruit) => {
    alert(`Selected: ${fruit}`)
  }

  return (
    <>
      <ComboBox options={options} onChange={handleFruitChange}>
        <ComboBoxRightElement />
        <ComboBoxClearElement />
        <ComboBoxInput placeholder="Select a fruit..." />
        <ComboBoxPopup />
      </ComboBox>
    </>
  );
}
```

### Combobox with custom option renderer, custom icon

#### 1. Only the renderer , keeping the <b>highlighted, selected </b> styles as default. Use this to quickly change just the content.

```jsx
function ComboBoxExample() {
  

  const options = [
    {
      label: 'bug',
      description: `Something isn't working`,
      value: 'bug',
      color: '#ff0000',
    },
    {
      label: 'documentation',
      description: `Improvements or addition to documentation`,
      value: 'documentation',
      color: '#0000ff',
    },
    {
      label: 'duplicate',
      description: `This issue or pull requests already exists`,
      value: 'duplicate',
      color: '#7f00ff',
    },
    {
      label: 'enhancement',
      description: `New feature or request`,
      value: 'enhancement',
      color: '#00ff00',
    },
    {
      label: 'good first issue',
      description: `Good for beginners`,
      value: 'first-issue',
      color: '#ffa500',
    },
    {
      label: 'help wanted',
      description: `Need more help`,
      value: 'help-wanted',
      color: '#844f38',
    }
  ];


  const [tag, setTag] = React.useState(null);
  return (
    <>
      <ComboBox value={tag} options={options} onChange={setTag}>
        <ComboBoxRightElement
          children={<Icon name="up-down" fontSize="1.2rem" />}
        />
        <ComboBoxClearElement />
        <ComboBoxInput placeholder="Select a fruit..." />
        <ComboBoxPopup
          itemHeight={60}
          renderItem={( {index, data, option, selected, highlighted, disabled} ) => ( 
            <Flex width="100%" alignItems="center">
              <Box w="5%">
                <Box backgroundColor={option.color} width="20px" height="20px" />
              </Box>
              <Flex w="95%" flexDirection="column" alignItems="left">
                <Box as="h4" fontWeight="bold">{option.label}</Box>
                <Box>{option.description}</Box>
              </Flex>
            </Flex>
          )}
        />
      </ComboBox>
    </>
  );
}
```

#### 2. Complete option renderer. Use this when you need complete control.


```jsx
function ComboBoxExample() {
  const getOptionStyles = (selected, highlighted, disabled) => {

    // Here, the default hover, selected and disabled style has been changed.
    // Also complete control of select box styling has been changed.

    const styles = {
      display: "flex",
      alignItems: "center",
      flex: "0 0 auto",
      width: "full",
      userSelect: "none",
      transition: "background-color 220ms, color 220ms",
      rounded: "sm",
      outline: "none",
      textAlign: "left",
      textDecoration: "none",
      color: disabled ? "gray.400" : "inherit",
      pointerEvents: disabled ? "none" : "auto",
      px: 4,
      bg: selected
        ? `teal.300`
        : highlighted
        ? `teal.100`
        : "transparent",
      _active: {
        bg: 'gray.200',
      },
      _focus: {
        shadow: "outline",
        outline: 0,
      },
      _disabled: {
        opacity: 0.4,
        cursor: "not-allowed",
      },
      _before: {
        position: "absolute",
        content: "''",
        left: 0,
        top: "50%",
        right: 0,
        borderTop: disabled ? '1px solid' : null,
        borderColor: 'red',
      }
    }

    return styles;
  }

  // Set of options
  const options = [
    {
      label: 'bug',
      description: `Something isn't working`,
      value: 'bug',
      color: '#ff0000',
      disabled: true
    },
    {
      label: 'documentation',
      description: `Improvements or addition to documentation`,
      value: 'documentation',
      color: '#0000ff',
    },
    {
      label: 'duplicate',
      description: `This issue or pull requests already exists`,
      value: 'duplicate',
      color: '#7f00ff',
    },
    {
      label: 'enhancement',
      description: `New feature or request`,
      value: 'enhancement',
      color: '#00ff00',
    },
    {
      label: 'good first issue',
      description: `Good for beginners`,
      value: 'first-issue',
      color: '#ffa500',
    },
    {
      label: 'help wanted',
      description: `Need more help`,
      value: 'help-wanted',
      color: '#844f38',
    }
  ];

  const [tag, setTag] = React.useState(null);

  return (
    <>
      <ComboBox value={tag} options={options} onChange={setTag}>
        <ComboBoxRightElement />
        <ComboBoxClearElement />
        <ComboBoxInput placeholder="Select a fruit..." />
        <ComboBoxPopup
          itemHeight={60}
          renderOption={({ 
            index, 
            data, 
            option, 
            selected, 
            highlighted, 
            disabled, 
            style, 
            getOptionProps 
          }) => (
              <PseudoBox
                {...getOptionProps({ index, option })}
                {...getOptionStyles(selected, highlighted, disabled)}  
                style={style}
              >
              <Flex width="100%" alignItems="center">
                <Box w="5%">
                  <Box backgroundColor={option.color} width="20px" height="20px" />
                </Box>
                <Flex w="95%" flexDirection="column" alignItems="left">
                  <Box as="h4" fontWeight="bold">{option.label}</Box>
                  <Box>{option.description}</Box>
                </Flex>
              </Flex>
            </PseudoBox>
          )}
        />
      </ComboBox>
    </>
  );
}
```

### ComboBox with large options and disabled set

```jsx
function ComboBoxExample() {
  const fruits = [
    "Acai",
    "Apples",
    "Apricots",
    "Avocado",
    "Ackee",
    "Bananas",
    "Bilberries",
    "Blueberries",
    "Blackberries",
    "Boysenberries",
    "Bread fruit",
    "Cantaloupes(cantalope)",
    "Chocolate - Fruit",
    "Cherimoya",
    "Cherries",
    "Cranberries",
    "Cucumbers",
    "Currants",
    "Dates",
    "Durian",
    "Eggplant",
    "Elderberries",
    "Figs",
    "Gooseberries",
    "Grapes",
    "Grapefruit",
    "Guava",
    "Honeydew melons",
    "Horned melon(Kiwano)",
    "Huckleberries",
    "Ita Palm",
    "Jujubes",
    "Kiwis",
    "Kumquat",
    "Lemons",
    "Limes",
    "Lychees",
    "Mangos",
    "Mangosteen",
    "Mulberries",
    "Muskmelon",
    "Nectarines",
    "Ogden melons",
    "Olives",
    "Oranges",
    "Papaya",
    "Passion fruit",
    "Peaches",
    "Pears",
    "Peppers",
    "Persimmon",
    "Pineapple",
    "Plums",
    "Pluot",
    "Pomegranate",
    "Prickly Pear",
    "Quince",
    "Rambuton",
    "Raspberries",
    "Rose Apple",
    "Starfruit",
    "Sapadilla",
    "Strawberries",
    "Tamarind",
    "Tangelo",
    "Tangerines",
    "Tomatoes",
    "Ugli fruit",
    "Voavanga(Spanish Tamarind)",
    "Watermelons",
    "Xigua melon",
    "Yellow watermelon",
    "Zucchini",
  ];

  const options = fruits.map((d, i) => ({
    value: d,
    label: d,
    disabled: i % 4 === 0,
  }));

  const [fruit, setFruit] = React.useState(null);
  return (
    <>
      <ComboBox value={fruit} options={options} onChange={setFruit}>
        <ComboBoxRightElement />
        <ComboBoxClearElement />
        <ComboBoxInput placeholder="Select a fruit..." />
        <ComboBoxPopup />
      </ComboBox>
    </>
  );
}
```

## ComboBox with Async fetching

```jsx
function ComboBoxExample() {

  const [cacheOptions, setCacheOptions] = React.useState([])

  // Entire select option lifecycle is cached with countries starting with 'a'
  // Cache options can be used to show options when no option is selected and nothing istyped.
  // Once the user starts typing, the new set of options are fetched
  // Once we clear all options, cache gets loaded
  // cacheOptions can be dynamic like in here or can be a static array set
  React.useEffect(() => {
    axios
      .get(`https://restcountries.eu/rest/v2/name/a`)
      .then(response => {
        setCacheOptions(response.data.map(ep => ({
            label: `${ep.name}`,
            value: `${ep.name}`,
            code: `${ep.alpha2Code}`,
            timeZone: `${ep.timezones[0]}`
          })))
      })
      .catch(e => {
        alert('Failed async fetch ', e.message)
      });
  }, [])

  // Callback that fetches when debounced value changes
  const asyncFetchOptions = (value, successCb, errorCb) => {
    axios
      .get(`https://restcountries.eu/rest/v2/name/${value}`)
      .then(response => {
        successCb(
          response.data.map(ep => ({
            label: `${ep.name}`,
            value: `${ep.name}`,
            code: `${ep.alpha2Code}`,
            timeZone: `${ep.timezones[0]}`
          })),
        );
      })
      .catch(e => {
        errorCb("Custom error message");
      });
  };

  const [fruit, setFruit] = React.useState(null);

  return (
    <>
      <ComboBox
        async
        value={fruit}
        onChange={setFruit}
        loadOptions={asyncFetchOptions}
        cacheOptions={cacheOptions}
      >
        <ComboBoxRightElement />
        <ComboBoxClearElement />
        <ComboBoxInput placeholder="Select a country..." />
        <ComboBoxPopup 
          itemHeight={60}
          pageSize={7}
          renderItem={( {index, data, option, selected, highlighted, disabled} ) => ( 
            <Flex width="100%" alignItems="center">
              <Box w="10%">
                <Avatar name={option.label} />
              </Box>
              <Flex w="90%" flexDirection="column" alignItems="left">
                <Box as="h4" fontWeight="bold">{option.label}</Box>
                <Box>{option.timeZone}</Box>
              </Flex>
            </Flex>
          )}
        />
      </ComboBox>
    </>
  );
}
```

```jsx
function ComboBoxExample() {
  const options = [
    { label: "Dan Abrahmov", img: "https://bit.ly/dan-abramov", value: '1' },
    { label: "Kola Tioluwani", img: "https://bit.ly/tioluwani-kolawole", value: '2' },
    { label: "Kent Dodds", img: "https://bit.ly/kent-c-dodds", value: '3' },
    { label: "Ryan Florence", img: "https://bit.ly/ryan-florence", value: '4'  },
    { label: "Prosper Otemuyiwa", img: "https://bit.ly/prosper-baba", value: '5' },
    { label: "Christian Nwamba", img: "https://bit.ly/code-beast", value: '6' },
    { label: "Segun Adebayo", img: "https://bit.ly/sage-adebayo", value: '7' },
  ]
  

  const [user, setUser] = React.useState(null)

  return (
    <>
      <ComboBox value={user} options={options} onChange={setUser}>
        <ComboBoxRightElement />
        <ComboBoxClearElement />
        <ComboBoxInput
          placeholder="Select user..."
          renderSelectedOption={(option) => (
            <Flex w="100%" alignItems="center">
              <Avatar name={option.label} src={option.img} size="xs" mr={2} />
              <Box as="h4" fontWeight="bold">{option.label}</Box>
            </Flex>
          )}
        />
        <ComboBoxPopup 
          itemHeight={60}
          renderItem={({ option }) => (
            <Flex w="100%" alignItems="center">
              <Box w="10%">
                <Avatar name={option.label} src={option.img} />
              </Box>
              <Flex w="90%" flexDirection="column" alignItems="left">
                <Box as="h4" fontWeight="bold">{option.label}</Box>
              </Flex>
            </Flex>
          )}
        />
      </ComboBox>
    </>
  );
}
```